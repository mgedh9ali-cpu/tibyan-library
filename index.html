<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙƒØªØ¨Ø© ØªØ¨ÙŠØ§Ù† | Ù†Ø³Ø®Ø© Ø­ÙŠØ²ÙˆÙ… Ø§Ù„Ø°ÙƒÙŠØ©</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <style>
        :root {
            --p: #2C1B18;    
            --g: #D4AF37;    
            --bg: #FDFCF9;   
            --card: #ffffff; 
            --text: #2C1B18; 
            --gray: #999;
        }

        .dark-mode {
            --bg: #121212;
            --card: #1e1e1e;
            --text: #e0e0e0;
            --p: #D4AF37;
            --gray: #bbb;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding-bottom: 110px;
            transition: all 0.3s ease;
            direction: rtl;
            overflow-x: hidden;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--p);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 20px;
            box-sizing: border-box;
        }

        .login-card {
            background: white;
            padding: 30px;
            border-radius: 30px;
            width: 100%;
            max-width: 400px;
            color: var(--p);
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        }

        .login-input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 12px;
            border: 1px solid #ddd;
            box-sizing: border-box;
        }

        .google-btn {
            background: #ffffff;
            color: #757575;
            border: 1px solid #ddd;
            padding: 12px;
            border-radius: 12px;
            width: 100%;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .enter-btn {
            background: var(--g);
            color: var(--p);
            border: none;
            padding: 15px;
            border-radius: 12px;
            width: 100%;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
        }

        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        .main-header {
            background-color: var(--p);
            color: white;
            padding: 30px 20px;
            text-align: center;
            border-radius: 0 0 40px 40px;
        }

        .user-welcome {
            background: rgba(212, 175, 55, 0.2);
            padding: 10px;
            border-radius: 15px;
            margin: 15px;
            font-size: 14px;
            text-align: center;
            border: 1px dashed var(--g);
        }

        .search-container { padding: 20px; position: sticky; top: 0; background: var(--bg); z-index: 100; }
        .search-bar { width: 100%; padding: 15px; border-radius: 20px; border: 2px solid var(--p); background: var(--card); color: var(--text); outline: none; box-sizing: border-box; }
        .book-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 20px; }
        .book-card { background: var(--card); border-radius: 25px; padding: 15px; text-align: center; box-shadow: 0 8px 15px rgba(0,0,0,0.05); position: relative; }
        .book-card img { width: 100%; border-radius: 15px; height: 160px; object-fit: cover; cursor: pointer; }
        .fav-btn { position: absolute; top: 20px; right: 20px; background: white; border: none; border-radius: 50%; width: 35px; height: 35px; color: #ff4757; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .page-section { display: none; padding: 20px; animation: slideUp 0.5s ease; }
        .active-section { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: var(--card); display: flex; justify-content: space-around; padding: 15px 0; box-shadow: 0 -5px 25px rgba(0,0,0,0.05); z-index: 1100; }
        .nav-item { background: none; border: none; color: var(--gray); font-size: 11px; flex: 1; }
        .nav-item.active { color: var(--p); font-weight: bold; }
        .audio-player { position: fixed; bottom: 90px; width: 90%; left: 5%; background: var(--p); color: white; padding: 15px; border-radius: 25px; display: none; align-items: center; gap: 15px; z-index: 1000; }
        .ward-container { background: var(--p); color: white; padding: 20px; border-radius: 25px; margin-bottom: 25px; }
    </style>
</head>
<body>

<div id="login-screen">
    <div class="login-card">
        <h2 style="margin-top:0;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ØªØ¨ÙŠØ§Ù† ğŸ“š</h2>
        <p style="font-size: 14px; color: #666;">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„ØªØ¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</p>
        
        <button class="google-btn" onclick="googleLogin()">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" width="20">
            Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¬ÙˆØ¬Ù„
        </button>

        <div style="margin: 10px 0; font-size: 12px; color: #999;">Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙŠØ¯ÙˆÙŠØ§Ù‹</div>

        <input type="text" id="userName" class="login-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ±ÙŠÙ…">
        <input type="number" id="userAge" class="login-input" placeholder="Ø§Ù„Ø¹Ù…Ø±">
        <input type="text" id="userCountry" class="login-input" placeholder="Ø§Ù„Ø¨Ù„Ø¯">
        
        <button class="enter-btn" onclick="manualLogin()">Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ÙƒØªØ¨Ø© ğŸš€</button>
    </div>
</div>

<div id="app-content" style="display:none;">
    <header class="main-header">
        <h2 style="margin:0;">Ù…ÙƒØªØ¨Ø© ØªØ¨ÙŠØ§Ù† Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h2>
        <p style="margin:5px 0 0; font-size:14px; opacity:0.8;">Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø¹Ø±ÙØ© ÙˆØ§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</p>
    </header>

    <div id="welcomeMsg" class="user-welcome"></div>

    <main>
        <section id="home" class="page-section active-section">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-bar" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙƒØªØ§Ø¨..." onkeyup="searchBooks()">
            </div>
            <div id="grid" class="book-grid">
                <div class="book-card">
                    <button class="fav-btn" onclick="toggleFav(101)"><i class="far fa-heart"></i></button>
                    <img src="https://via.placeholder.com/150/2C1B18/white?text=Ø²Ø§Ø¯+Ø§Ù„Ù…Ø¹Ø§Ø¯" onclick="playAudio('Ø²Ø§Ø¯ Ø§Ù„Ù…Ø¹Ø§Ø¯', 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', 101)">
                    <h4>Ù…Ø®ØªØµØ± Ø²Ø§Ø¯ Ø§Ù„Ù…Ø¹Ø§Ø¯</h4>
                </div>
            </div>
        </section>

        <section id="mylist" class="page-section">
            <div class="ward-container">
                <h3><i class="fas fa-mosque"></i> Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
                <input type="number" id="wardPages" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª" style="width:45%; padding:10px; border-radius:10px; border:none;">
                <input type="time" id="wardTime" style="width:45%; padding:10px; border-radius:10px; border:none;" onchange="saveWardSettings()">
                <p id="wardStatus" style="font-size:12px; margin-top:10px;"></p>
            </div>
            <h3>â­ Ù…ÙØ¶Ù„Ø§ØªÙŠ</h3>
            <div id="fav-grid" class="book-grid"></div>
        </section>

        <section id="snippets" class="page-section">
            <button onclick="generateAIQuote()" style="width:100%; padding:18px; background:var(--g); border:none; border-radius:15px; font-weight:bold;">ØªÙˆÙ„ÙŠØ¯ Ù…Ù‚ØªØ·Ù Ø¬Ø¯ÙŠØ¯ âœ¨</button>
            <div id="quoteContainer" style="display:none; margin-top:25px;">
                <div id="quoteCard" style="background:white; padding:20px; border-radius:20px; border-right:8px solid var(--g);">
                    <p id="quoteText"></p>
                </div>
            </div>
        </section>

        <section id="profile" class="page-section">
            <div style="text-align:center; padding:20px; background:var(--card); border-radius:20px;">
                <h3 id="profileName"></h3>
                <p id="profileDetails"></p>
                <button onclick="logout()" style="background:#ff4757; color:white; border:none; padding:10px 20px; border-radius:10px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </section>
    </main>

    <div id="player" class="audio-player">
        <div style="flex:1">
            <div id="track-title" style="font-size:12px; font-weight:bold;"></div>
            <audio id="mainAudio" controls style="width:100%; height:30px;"></audio>
        </div>
    </div>

    <nav class="nav-bar">
        <button class="nav-item active" onclick="nav('home', this)"><i class="fas fa-home"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="nav-item" onclick="nav('mylist', this)"><i class="fas fa-star"></i>Ù‚Ø§Ø¦Ù…ØªÙŠ</button>
        <button class="nav-item" onclick="nav('snippets', this)"><i class="fas fa-quote-right"></i>Ù…Ù‚ØªØ·ÙØ§Øª</button>
        <button class="nav-item" onclick="nav('profile', this)"><i class="fas fa-user-cog"></i>Ø£Ù†Ø§</button>
    </nav>
</div>

<script>
    const MY_KEY = "AIzaSyC_Q_wn2HmNoEGaTAbflvivPklJD2I_5pU";
    
    // --- Ù†Ø¸Ø§Ù… Ø§Ù„Ø¯Ø®ÙˆÙ„ ---
    function manualLogin() {
        const name = document.getElementById('userName').value;
        const age = document.getElementById('userAge').value;
        const country = document.getElementById('userCountry').value;

        if(!name || !age || !country) return alert("ÙŠØ§ Ø­ÙŠØ²ÙˆÙ… Ø¹Ø¨ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©!");

        const user = { name, age, country, method: 'Manual' };
        localStorage.setItem('tebyan_user', JSON.stringify(user));
        startApp();
    }

    function googleLogin() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¯Ø®ÙˆÙ„ Ø¬ÙˆØ¬Ù„
        const user = { name: "Ø­ÙŠØ²ÙˆÙ… (Ø¹Ø¨Ø± Ø¬ÙˆØ¬Ù„)", age: "20", country: "Ø³ÙˆØ±ÙŠØ§", method: 'Google' };
        localStorage.setItem('tebyan_user', JSON.stringify(user));
        startApp();
    }

    function startApp() {
        const user = JSON.parse(localStorage.getItem('tebyan_user'));
        if(user) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app-content').style.display = 'block';
            document.getElementById('welcomeMsg').innerText = `Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ${user.name} Ù…Ù† ${user.country} ÙÙŠ Ù…ÙƒØªØ¨ØªÙƒ âœ¨`;
            document.getElementById('profileName').innerText = user.name;
            document.getElementById('profileDetails').innerText = `${user.age} Ø³Ù†Ø© | ${user.country}`;
        }
    }

    function logout() {
        localStorage.removeItem('tebyan_user');
        location.reload();
    }

    // --- Ø¨Ù‚ÙŠØ© ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ---
    let books = JSON.parse(localStorage.getItem('lib_books')) || [
        {id: 101, title: 'Ù…Ø®ØªØµØ± Ø²Ø§Ø¯ Ø§Ù„Ù…Ø¹Ø§Ø¯', audio: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', img: 'https://via.placeholder.com/150/2C1B18/white?text=Ø²Ø§Ø¯+Ø§Ù„Ù…Ø¹Ø§Ø¯'}
    ];
    let favorites = JSON.parse(localStorage.getItem('lib_favs')) || [];

    function nav(id, btn) {
        document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active-section'));
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.getElementById(id).classList.add('active-section');
        btn.classList.add('active');
        if(id === 'mylist') renderFavs();
    }

    function renderBooks() {
        document.getElementById('grid').innerHTML = books.map(book => `
            <div class="book-card">
                <button class="fav-btn" onclick="toggleFav(${book.id})"><i class="${favorites.includes(book.id) ? 'fas' : 'far'} fa-heart"></i></button>
                <img src="${book.img}" onclick="playAudio('${book.title}', '${book.audio}', ${book.id})">
                <h4>${book.title}</h4>
            </div>
        `).join('');
    }

    function toggleFav(id) {
        if(favorites.includes(id)) favorites = favorites.filter(fid => fid !== id);
        else favorites.push(id);
        localStorage.setItem('lib_favs', JSON.stringify(favorites));
        renderBooks();
    }

    function renderFavs() {
        const favList = books.filter(b => favorites.includes(b.id));
        document.getElementById('fav-grid').innerHTML = favList.map(book => `
            <div class="book-card"><img src="${book.img}" onclick="playAudio('${book.title}', '${book.audio}', ${book.id})"><h4>${book.title}</h4></div>
        `).join('') || '<p>Ø§Ù„Ù…ÙØ¶Ù„Ø© Ø®Ø§Ù„ÙŠØ©</p>';
    }

    function playAudio(title, url, id) {
        const player = document.getElementById('player');
        const audio = document.getElementById('mainAudio');
        document.getElementById('track-title').innerText = title;
        audio.src = url;
        player.style.display = 'flex';
        audio.play();
    }

    async function generateAIQuote() {
        const text = document.getElementById('quoteText');
        document.getElementById('quoteContainer').style.display = 'block';
        text.innerText = "ÙƒØ­ÙŠÙ„Ø§Ù† ÙŠÙÙƒØ±... â˜•";
        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${MY_KEY}`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({contents: [{parts: [{text: "Ø£Ø¹Ø·Ù†ÙŠ Ø­ÙƒÙ…Ø© Ø´Ø±Ø¹ÙŠØ© Ù‚ØµÙŠØ±Ø© Ø¨Ù„Ù‡Ø¬Ø© Ø¥Ø¯Ù„Ø¨ÙŠØ©."}]}]})
            });
            const data = await res.json();
            text.innerText = data.candidates[0].content.parts[0].text;
        } catch(e) { text.innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„!"; }
    }

    window.onload = () => {
        if(localStorage.getItem('tebyan_user')) startApp();
        renderBooks();
    };
</script>
</body>
</html>
